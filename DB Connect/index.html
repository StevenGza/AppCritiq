<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>TestAccess.java</title>


  <meta http-equiv="content-type" content="text/html; charset=UTF-8">

  <style type="text/css">
<!--
body {color: #000000; background-color: #ffffff; font-family: Monospaced}
table {color: #000000; background-color: #e9e8e2; font-family: Monospaced}
.ST0 {color: #969696; font-family: Monospaced; font-weight: bold}
.comment {color: #969696}
.ST1 {color: #ce7b00; font-family: Monospaced; font-weight: bold}
.character {color: #ce7b00}
.keyword-directive {color: #0000e6}
-->
  </style>
</head>


<body>

<table style="width: 958px; height: 171px;">

  <tbody>

    <tr>

      <td align="center">Java Source Code Example<br>

      <big>Accessing a Microsoft Access Database MDB File from
Java</big><br>

No setup in ODBC required<br>

Display all table names found in database<br>

      <small><small><br>

Download Source Code</small></small> <a href="TestAccess.java">TestAccess.java</a> <small><small>Laai
Bronkode af</small></small><br>

      <br>

      <small>Home <a target="_blank" href="http://www.javak.co.za/">www.javak.co.za</a></small>
      <small>Tuiste</small></td>

    </tr>

  </tbody>
</table>

<pre><span class="comment">/**</span><br><span class="comment"> * </span><span class="comment">Opens</span> <span class="comment">a</span> <span class="comment">Microsoft</span> <span class="comment">Access</span> <span class="comment">Database</span> <span class="comment">without</span> <span class="comment">having</span> <span class="comment">need</span> <span class="comment">to</span> <span class="comment">have</span> <span class="comment">access</span> <span class="comment">rights</span><br><span class="comment"> * </span><span class="comment">to</span> <span class="comment">the</span> <span class="comment">Administrative</span> <span class="comment">Tools</span> <span class="comment">on</span> <span class="comment">Windows</span> <span class="comment">to</span> <span class="comment">set</span> <span class="comment">up</span> <span class="comment">ODBC</span><span class="comment">.</span><span class="comment">.</span><br><span class="comment"> * </span><br><span class="comment"> * </span><span class="comment">Maak</span><span class="comment"> '</span><span class="comment">n</span> <span class="comment">Microsoft</span> <span class="comment">Access</span> <span class="comment">databasis</span> <span class="comment">oop</span> <span class="comment">in</span> <span class="comment">Java</span> <span class="comment">sonder</span> <span class="comment">dat</span> <span class="comment">enige</span> <span class="comment">verstellings</span><br><span class="comment"> * </span><span class="comment">in</span> <span class="comment">die</span> <span class="comment">Administrative</span> <span class="comment">Tools</span> <span class="comment">gemaak</span> <span class="comment">hoef</span> <span class="comment">te</span> <span class="comment">word</span> <span class="comment">vir</span> <span class="comment">ODBC</span><span class="comment">.</span><br><span class="comment"> * </span><br><span class="comment"> * </span><span class="comment">Die</span> <span class="comment">res</span> <span class="comment">van</span> <span class="comment">die</span> <span class="comment">kommentaar</span> <span class="comment">is</span> <span class="comment">meestal</span> <span class="comment">in</span> <span class="comment">Engels</span><span class="comment">, </span><span class="comment">ek</span> <span class="comment">is</span> <span class="comment">seker</span> <span class="comment">daarvan</span> <span class="comment">dat</span> <span class="comment">almal</span> <span class="comment">darem</span><br><span class="comment"> * </span><span class="comment">sal</span> <span class="comment">saam</span> <span class="comment">stem</span> <span class="comment">dat</span> <span class="comment">dit</span> <span class="comment">moeilik</span> <span class="comment">is</span> <span class="comment">om</span> <span class="comment">Java</span> <span class="comment">kode</span> <span class="comment">in</span><span class="comment"> "</span><span class="comment">suiwer</span><span class="comment">" </span><span class="comment">Afrikaans</span> <span class="comment">te</span> <span class="comment">verduidelik</span><span class="comment">.</span><br><span class="comment">*/</span><br><span class="keyword-directive">import</span> java.awt.Toolkit;<br><span class="keyword-directive">import</span> java.sql.*;<br><span class="keyword-directive">import</span> javax.swing.JOptionPane;<br><br><span class="comment">/**</span><br><span class="comment"> *</span><br><span class="comment"> * </span><span class="ST0">@author</span> <span class="comment">Ewald</span> <span class="comment">Horn</span><br><span class="comment"> * </span><span class="ST0">@company</span> <span class="comment">JavaK</span><br><span class="comment">*/</span><br><span class="keyword-directive">public</span> <span class="keyword-directive">class</span> TestAccess<br>{<br><br> <span class="keyword-directive">public</span> <span class="keyword-directive">static</span> Connection con;<br> <span class="keyword-directive">public</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> String driver = <span class="character">"</span><span class="character">sun.jdbc.odbc.JdbcOdbcDriver</span><span class="character">"</span>;<br> <span class="keyword-directive">public</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> String url = <span class="character">"</span><span class="character">jdbc:odbc:DRIVER={Microsoft Access Driver (*.mdb)};DBQ=</span><span class="character">"</span>;<br> <span class="comment">/**</span><br><span class="comment"> * </span><span class="comment">The</span> <span class="comment">path</span> <span class="comment">to</span> <span class="comment">the</span> <span class="comment">database</span> <span class="comment">file</span><span class="comment">.</span> <span class="comment">It</span> <span class="comment">is</span> <span class="comment">important</span> <span class="comment">to</span> <span class="comment">remember</span> <span class="comment">that</span> <span class="comment">on</span> <span class="comment">Windows</span><br><span class="comment"> * </span><span class="comment">platforms</span> <span class="comment">the</span> <span class="comment">path</span> <span class="comment">character</span><span class="comment"> \ </span><span class="comment">must</span> <span class="comment">be</span> <span class="comment">escaped</span> <span class="comment">with</span> <span class="comment">another</span><span class="comment"> \</span><span class="comment">.</span><br><span class="comment">*/</span><br>String path;<br><span class="comment">//////////////////////////////////////////////////////////////////////////////// </span><br><span class="comment">/**</span> <span class="comment">Constructor</span> <br><span class="comment"> * </span><span class="comment">Sets</span> <span class="comment">the</span> <span class="comment">path</span> <span class="comment">to</span> <span class="comment">the</span> <span class="comment">database</span><span class="comment">.</span><br><span class="comment"> * </span><br><span class="comment"> * </span><span class="comment">Stel</span> <span class="comment">die</span> <span class="comment">pad</span> <span class="comment">na</span> <span class="comment">die</span> <span class="comment">databasis</span><span class="comment">.</span><br><span class="comment">*/</span><br><span class="keyword-directive">public</span> TestAccess()<br> {<br> path = <span class="character">"</span><span class="character">D:</span><span class="ST1">\\</span><span class="character">VideoShop.mdb</span><span class="character">"</span>;<br> }<br><br><span class="comment">////////////////////////////////////////////////////////////////////////////////</span><br><span class="comment">/**</span><br><span class="comment"> * </span><span class="comment">Runner</span> <span class="comment">method</span> <span class="comment">for</span> <span class="comment">the</span> <span class="comment">TestAccess</span> <span class="comment">class</span><span class="comment">.</span><br><span class="comment">*/</span><br><span class="keyword-directive">private</span> <span class="keyword-directive">void</span> go()<br> {<br> makeConnection();<br> displayStatus();<br> closeConnection();<br> }<br><br><span class="comment">//////////////////////////////////////////////////////////////////////////////// </span><br><span class="comment">/**</span><br><span class="comment"> * </span><span class="comment">Creates</span> <span class="comment">the</span> <span class="comment">database</span> <span class="comment">connection</span><span class="comment">.</span><br><span class="comment"> * </span><br><span class="comment"> * </span><span class="comment">Skep</span> <span class="comment">die</span> <span class="comment">brug</span> <span class="comment">na</span> <span class="comment">die</span> <span class="comment">databasis</span><span class="comment">.</span><br><span class="comment">*/</span><br><span class="keyword-directive">public</span> <span class="keyword-directive">void</span> makeConnection()<br> {<br> System.out.println(<span class="character">"</span><span class="ST1">\n</span><span class="ST1">\n</span><span class="ST1">\n</span><span class="character">Opening database...</span><span class="character">"</span>);<br> <span class="keyword-directive">try</span><br>{<br>Class.forName(driver);<br>con = DriverManager.getConnection(url + path);<br>} <span class="keyword-directive">catch</span> (Exception ex)<br> {<br> Toolkit q = Toolkit.getDefaultToolkit();<br> q.beep();<br> JOptionPane.showMessageDialog(<span class="keyword-directive">null</span>, <span class="character">"</span><span class="character">An error occurred while trying to set up the connection to database.</span><span class="ST1">\n</span><span class="character">"</span>,<br> <span class="character">"</span><span class="character">Database Error</span><span class="character">"</span>, JOptionPane.ERROR_MESSAGE);<br> System.err.println(ex);<br> System.exit(0);<br> }<br> }<br><br><span class="comment">//////////////////////////////////////////////////////////////////////////////// </span><br><span class="comment">/**</span><br><span class="comment"> * </span><span class="comment">Closes</span> <span class="comment">the</span> <span class="comment">connection</span> <span class="comment">cleanly</span><span class="comment">.</span><br><span class="comment"> * </span><br><span class="comment"> * </span><span class="comment">Sluit</span> <span class="comment">die</span> <span class="comment">databasis</span> <span class="comment">af</span><span class="comment">.</span><br><span class="comment">*/</span><br><span class="keyword-directive">public</span> <span class="keyword-directive">void</span> closeConnection()<br> {<br> System.out.println(<span class="character">"</span><span class="ST1">\n</span><span class="character">Closing database.</span><span class="character">"</span>);<br> <span class="keyword-directive">try</span><br>{<br>con.close();<br>} <span class="keyword-directive">catch</span> (Exception ex)<br> {<br> Toolkit q = Toolkit.getDefaultToolkit();<br> q.beep();<br> JOptionPane.showMessageDialog(<span class="keyword-directive">null</span>, <span class="character">"</span><span class="character">An error occurred while trying to close the database.</span><span class="ST1">\n</span><span class="character">"</span>,<br> <span class="character">"</span><span class="character">Database Error</span><span class="character">"</span>, JOptionPane.ERROR_MESSAGE);<br> System.err.println(ex);<br> }<br> }<br><br><span class="comment">////////////////////////////////////////////////////////////////////////////////</span><br><span class="comment">/**</span><br><span class="comment"> * </span><span class="comment">Displays</span> <span class="comment">some</span> <span class="comment">information</span> <span class="comment">regarding</span> <span class="comment">the</span> <span class="comment">database</span> <span class="comment">connection</span> <span class="comment">as</span> <span class="comment">well</span><br><span class="comment"> * </span><span class="comment">as</span> <span class="comment">a</span> <span class="comment">list</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">general</span> <span class="comment">TABLES</span> <span class="comment">in</span> <span class="comment">the</span> <span class="comment">database</span><span class="comment">.</span><br><span class="comment"> * </span><br><span class="comment"> * </span><span class="comment">Vertoon</span> <span class="comment">inligting</span> <span class="comment">oor</span> <span class="comment">die</span> <span class="comment">databasis</span> <span class="comment">asook</span> <span class="comment">die</span> <span class="comment">gewone</span> <span class="comment">TABLES</span> <span class="comment">in</span> <span class="comment">die</span><br><span class="comment"> * </span><span class="comment">databasis</span><span class="comment">.</span><br><span class="comment">*/</span><br><span class="keyword-directive">public</span> <span class="keyword-directive">void</span> displayStatus()<br> {<br> <span class="keyword-directive">if</span> (con != <span class="keyword-directive">null</span>)<br> {<br> <span class="keyword-directive">try</span><br>{<br>System.out.println(con.getCatalog()); <span class="comment">// display the database</span><br>DatabaseMetaData metaData = con.getMetaData(); <span class="comment">// retrieve information about the database</span><br>System.out.println(<span class="character">"</span><span class="character">Database Product : </span><span class="character">"</span> + metaData.getDatabaseProductName());<br> System.out.println(<span class="character">"</span><span class="character">Database Driver : </span><span class="character">"</span> + metaData.getDriverName());<br> System.out.println(<span class="character">"</span><span class="character">Tables for </span><span class="character">"</span> + metaData.getURL() + <span class="character">"</span><span class="character"> :</span><span class="ST1">\n</span><span class="character">"</span>);<br><br> ResultSet rs = metaData.getTables(<span class="keyword-directive">null</span>, <span class="keyword-directive">null</span>, <span class="keyword-directive">null</span>, <span class="keyword-directive">new</span> String[]{<span class="character">"</span><span class="character">TABLE</span><span class="character">"</span>});<br> <span class="keyword-directive">while</span> (rs.next())<br> {<br> System.out.println(rs.getString(3)); <span class="comment">// 3rd String contains the table name</span><br>}<br>rs.close();<br>} <span class="keyword-directive">catch</span> (Exception e)<br> {<br> System.err.println(<span class="character">"</span><span class="character">Error : </span><span class="character">"</span> + e);<br> }<br> }<br> }<br><br><span class="comment">////////////////////////////////////////////////////////////////////////////////</span><br><span class="comment">/**</span><br><span class="comment"> * </span><span class="comment">Main</span> <span class="comment">method</span> <span class="comment">for</span> <span class="comment">TestAccess</span><span class="comment">.</span><span class="comment">java</span><br><span class="comment"> * </span><span class="ST0">@param</span> <span class="comment">args</span><br><span class="comment">*/</span><br><span class="keyword-directive">public</span> <span class="keyword-directive">static</span> <span class="keyword-directive">void</span> main(String args[])<br> {<br> TestAccess testAccess = <span class="keyword-directive">new</span> TestAccess();<br> testAccess.go();<br> }<br>}</pre>

<br>

<table style="width: 958px; height: 171px;">

  <tbody>

    <tr>

      <td align="center"><small><small>Download
Source Code</small></small> <a href="TestAccess.java">TestAccess.java</a>
      <small><small>Laai
Bronkode af</small></small><br>

      <br>

      <small>Home <a target="_blank" href="http://www.javak.co.za/">www.javak.co.za</a></small>
      <small>Tuiste</small></td>

    </tr>

  </tbody>
</table>

</body>
</html>
